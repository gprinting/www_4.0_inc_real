<?
/*
 * Copyright (c) 2017 Nexmotion, Inc.
 * All rights reserved.
 *
 * 비규격 사이즈 관련 처리 함수
 *
 * REVISION HISTORY (reverse chronological order)
 *=============================================================================
 * 2017/04/18 엄준현 생성
 * 2017/11/15 최대/최소사이즈 관련함수 추가
 *=============================================================================
 */
define("INC_PATH", $_SERVER["INC"]);
include_once(INC_PATH . "/com/nexmotion/common/util/ConnectionPool.inc");
include_once(INC_PATH . "/common_lib/CommonUtil.inc");
include_once(INC_PATH . "/common_dao/ProductCommonDAO.inc");
include_once(INC_PATH . "/common_define/prdt_max_min_size_info.inc");

class NonStandardUtil {
    private $conn;
    private $dao;
    private $util;
    private $sticker_dc;

    public function __construct($param = []) {
        $this->setData($param);
    }

    public function setData($param) {
        if (empty($param["conn"])) {
            $cp = new ConnectionPool();
            $this->conn = $cp->getPooledConnection();
        } else {
            $this->conn = $param["conn"];
        }

        $this->dao = new ProductCommonDAO();

        if (empty($param["util"])) {
            $this->util = new CommonUtil();
        } else {
            $this->util = $param["util"];
        }

        $this->sticker_dc[500]	    = [0.75000,0.51000,0.58500,0.48000,0.43000,0.22000,0.25300,0.22000,0.26000,0.33940,0.26500,0.56480,0.58510,0.42840,0.46460,0.16360,0.26790,0.29850,0.47280,0.81200,0.29300];
        $this->sticker_dc[1000]	    = [0.65800,0.37000,0.39200,0.32000,0.39200,0.15000,0.17000,0.17000,0.17000,0.22300,0.17500,0.37830,0.39005,0.28635,0.29810,0.16360,0.17493,0.29850,0.31025,0.56500,0.19300];
        $this->sticker_dc[2000]	    = [0.66000,0.36000,0.36700,0.31000,0.36700,0.14000,0.16800,0.16800,0.17000,0.22300,0.17500,0.37830,0.39005,0.28635,0.29810,0.16360,0.17493,0.29850,0.31025,0.56300,0.19200];
        $this->sticker_dc[3000]	    = [0.65500,0.36000,0.36700,0.31000,0.36700,0.14000,0.16600,0.16600,0.16750,0.21600,0.17500,0.35630,0.36805,0.26835,0.28010,0.15860,0.16993,0.28050,0.29225,0.56100,0.19100];
        $this->sticker_dc[4000]	    = [0.64300,0.36000,0.36700,0.31000,0.36700,0.14000,0.16400,0.16400,0.16500,0.21200,0.17500,0.34980,0.36155,0.26335,0.27510,0.15670,0.16803,0.27550,0.28725,0.55900,0.19000];
        $this->sticker_dc[5000]	    = [0.63000,0.35000,0.34300,0.30000,0.34300,0.13000,0.16200,0.16200,0.16250,0.20800,0.17500,0.34330,0.35505,0.25835,0.27010,0.15480,0.16613,0.27050,0.28225,0.55700,0.18900];
        $this->sticker_dc[6000]	    = [0.62600,0.34000,0.31800,0.29000,0.31800,0.13000,0.16000,0.16000,0.16000,0.20400,0.16650,0.33680,0.34855,0.25335,0.26510,0.15290,0.16423,0.26550,0.27725,0.55500,0.18800];
        $this->sticker_dc[7000]	    = [0.62000,0.34000,0.31800,0.29000,0.31800,0.12000,0.15800,0.15800,0.15750,0.20000,0.16300,0.33030,0.34205,0.24835,0.26010,0.15100,0.16233,0.26050,0.27225,0.55300,0.18700];
        $this->sticker_dc[8000]	    = [0.61900,0.34000,0.31800,0.29000,0.31800,0.12000,0.15600,0.15600,0.15500,0.19600,0.15950,0.32380,0.33555,0.24335,0.25510,0.14910,0.16043,0.25550,0.26725,0.55100,0.18600];
        $this->sticker_dc[9000]	    = [0.61500,0.34000,0.31800,0.29000,0.31800,0.12000,0.15400,0.15400,0.15250,0.19200,0.15600,0.31730,0.32905,0.23835,0.25010,0.14720,0.15853,0.25050,0.26225,0.54900,0.18500];
        $this->sticker_dc[10000]	= [0.61100,0.33000,0.29400,0.28000,0.29400,0.12000,0.15200,0.15200,0.15000,0.18800,0.15250,0.31080,0.32255,0.23335,0.24510,0.14530,0.15663,0.24550,0.25725,0.54700,0.18400];
        $this->sticker_dc[11000]	= [0.60700,0.33000,0.29400,0.28000,0.29400,0.12000,0.15100,0.15100,0.14940,0.19075,0.15250,0.31720,0.32895,0.23785,0.24960,0.14520,0.15673,0.25000,0.26175,0.54500,0.18300];
        $this->sticker_dc[12000]	= [0.60200,0.33000,0.29400,0.28000,0.29400,0.12000,0.15100,0.15000,0.14880,0.18950,0.15250,0.31710,0.32885,0.23735,0.24910,0.14320,0.15493,0.24950,0.26125,0.54300,0.18200];
        $this->sticker_dc[13000]	= [0.60000,0.33000,0.29400,0.28000,0.29400,0.12000,0.15000,0.14900,0.14820,0.18825,0.15250,0.31700,0.32875,0.23685,0.24860,0.14120,0.15313,0.24900,0.26075,0.54100,0.18100];
        $this->sticker_dc[14000]	= [0.59400,0.33000,0.29400,0.28000,0.29400,0.12000,0.15000,0.14800,0.14760,0.18700,0.15250,0.31690,0.32865,0.23635,0.24810,0.13920,0.15133,0.24850,0.26025,0.53900,0.18000];
        $this->sticker_dc[15000]	= [0.59200,0.33000,0.29400,0.28000,0.29400,0.12000,0.14900,0.14700,0.14700,0.18575,0.15250,0.31680,0.32855,0.23585,0.24760,0.13720,0.14953,0.24800,0.25975,0.53700,0.17900];
        $this->sticker_dc[16000]	= [0.58600,0.33000,0.29400,0.28000,0.29400,0.12000,0.14900,0.14600,0.14640,0.18450,0.15250,0.31670,0.32845,0.23535,0.24710,0.13520,0.14773,0.24750,0.25925,0.53500,0.17800];
        $this->sticker_dc[17000]	= [0.58200,0.33000,0.29400,0.28000,0.29400,0.12000,0.14800,0.14500,0.14580,0.18325,0.15250,0.31660,0.32835,0.23485,0.24660,0.13320,0.14593,0.24700,0.25875,0.53300,0.17700];
        $this->sticker_dc[18000]	= [0.57700,0.33000,0.29400,0.28000,0.29400,0.12000,0.14800,0.14400,0.14520,0.18200,0.15250,0.31650,0.32825,0.23435,0.24610,0.13120,0.14413,0.24650,0.25825,0.53100,0.17600];
        $this->sticker_dc[19000]	= [0.57300,0.33000,0.29400,0.28000,0.29400,0.12000,0.14700,0.14300,0.14460,0.18075,0.15250,0.31640,0.32815,0.23385,0.24560,0.12920,0.14233,0.24600,0.25775,0.52900,0.17500];
        $this->sticker_dc[20000]	= [0.56800,0.33000,0.29400,0.28000,0.29400,0.12000,0.14700,0.14200,0.14400,0.17950,0.14900,0.31630,0.32805,0.23335,0.24510,0.12720,0.14053,0.24550,0.25725,0.52700,0.17400];
        $this->sticker_dc[21000]	= [0.56500,0.33000,0.29400,0.28000,0.29400,0.12000,0.14600,0.14100,0.14340,0.17850,0.14450,0.31629,0.32804,0.23332,0.24507,0.12710,0.14043,0.24547,0.25722,0.52500,0.17300];
        $this->sticker_dc[22000]	= [0.55900,0.33000,0.29400,0.28000,0.29400,0.12000,0.14600,0.14000,0.14280,0.17750,0.14450,0.31628,0.32803,0.23330,0.24505,0.12700,0.14033,0.24545,0.25720,0.52300,0.17200];
        $this->sticker_dc[23000]	= [0.55400,0.33000,0.29400,0.28000,0.29400,0.12000,0.14500,0.13900,0.14220,0.17650,0.14450,0.31627,0.32802,0.23327,0.24502,0.12690,0.14023,0.24542,0.25717,0.52100,0.17100];
        $this->sticker_dc[24000]	= [0.55100,0.33000,0.29400,0.28000,0.29400,0.12000,0.14500,0.13800,0.14160,0.17550,0.14450,0.31626,0.32801,0.23325,0.24500,0.12680,0.14013,0.24540,0.25715,0.51900,0.17000];
        $this->sticker_dc[25000]	= [0.54800,0.33000,0.29400,0.28000,0.29400,0.12000,0.14400,0.13700,0.14100,0.17450,0.14450,0.31625,0.32800,0.23322,0.24497,0.12670,0.14003,0.24537,0.25712,0.51700,0.16900];
        $this->sticker_dc[26000]	= [0.54200,0.33000,0.29400,0.28000,0.29400,0.12000,0.14400,0.13700,0.14040,0.17350,0.14450,0.31624,0.32799,0.23320,0.24495,0.12660,0.13993,0.24535,0.25710,0.51500,0.16800];
        $this->sticker_dc[27000]	= [0.53700,0.33000,0.29400,0.28000,0.29400,0.11700,0.14300,0.13600,0.13980,0.17250,0.14450,0.31623,0.32798,0.23317,0.24492,0.12650,0.13983,0.24532,0.25707,0.51300,0.16700];
        $this->sticker_dc[28000]	= [0.53300,0.33000,0.29400,0.28000,0.29400,0.11400,0.14300,0.13500,0.13920,0.17150,0.14450,0.31622,0.32797,0.23315,0.24490,0.12640,0.13973,0.24530,0.25705,0.51100,0.16600];
        $this->sticker_dc[29000]	= [0.53000,0.33000,0.29400,0.28000,0.29400,0.11100,0.14200,0.13500,0.13920,0.17050,0.14450,0.31621,0.32796,0.23312,0.24487,0.12630,0.13963,0.24527,0.25702,0.50900,0.16500];
        $this->sticker_dc[30000]	= [0.52500,0.33000,0.29400,0.28000,0.29400,0.11000,0.14200,0.13500,0.13920,0.16950,0.14450,0.31620,0.32795,0.23310,0.24485,0.12620,0.13953,0.24525,0.25700,0.50900,0.16400];
        $this->sticker_dc[31000]	= [0.52200,0.33000,0.29400,0.28000,0.29400,0.11000,0.14100,0.13500,0.13920,0.16950,0.14450,0.31620,0.32795,0.23310,0.24485,0.12620,0.13953,0.24525,0.25700,0.50900,0.16400];
        $this->sticker_dc[32000]	= [0.51500,0.33000,0.29400,0.28000,0.29400,0.11000,0.14100,0.13500,0.13920,0.16950,0.14450,0.31620,0.32795,0.23310,0.24485,0.12620,0.13953,0.24525,0.25700,0.50900,0.16400];
        $this->sticker_dc[33000]	= [0.51300,0.33000,0.29400,0.28000,0.29400,0.11000,0.14000,0.13500,0.13920,0.16950,0.14450,0.31620,0.32795,0.23310,0.24485,0.12620,0.13953,0.24525,0.25700,0.50900,0.16400];
        $this->sticker_dc[34000]	= [0.50600,0.33000,0.29400,0.28000,0.29400,0.11000,0.14000,0.13500,0.13920,0.16950,0.14450,0.31620,0.32795,0.23310,0.24485,0.12620,0.13953,0.24525,0.25700,0.50900,0.16400];
        $this->sticker_dc[35000]	= [0.50400,0.33000,0.29400,0.28000,0.29400,0.11000,0.14000,0.13500,0.13920,0.16950,0.14450,0.31620,0.32795,0.23310,0.24485,0.12620,0.13953,0.24525,0.25700,0.50900,0.16400];
        $this->sticker_dc[36000]	= [0.50200,0.33000,0.29400,0.28000,0.29400,0.11000,0.14000,0.13500,0.13920,0.16950,0.14450,0.31620,0.32795,0.23310,0.24485,0.12620,0.13953,0.24525,0.25700,0.50900,0.16400];
        $this->sticker_dc[37000]	= [0.50100,0.33000,0.29400,0.28000,0.29400,0.11000,0.14000,0.13500,0.13920,0.16950,0.14450,0.31620,0.32795,0.23310,0.24485,0.12620,0.13953,0.24525,0.25700,0.50900,0.16400];
        $this->sticker_dc[38000]	= [0.50100,0.33000,0.29400,0.28000,0.29400,0.11000,0.14000,0.13500,0.13920,0.16950,0.14450,0.31620,0.32795,0.23310,0.24485,0.12620,0.13953,0.24525,0.25700,0.50900,0.16400];
        $this->sticker_dc[39000]	= [0.50100,0.33000,0.29400,0.28000,0.29400,0.11000,0.14000,0.13500,0.13920,0.16950,0.14450,0.31620,0.32795,0.23310,0.24485,0.12620,0.13953,0.24525,0.25700,0.50900,0.16400];
        $this->sticker_dc[40000]	= [0.50100,0.33000,0.29400,0.28000,0.29400,0.11000,0.14000,0.13500,0.13920,0.16950,0.14450,0.31620,0.32795,0.23310,0.24485,0.12620,0.13953,0.24525,0.25700,0.50900,0.16400];
        $this->sticker_dc[41000]	= [0.50100,0.33000,0.28200,0.28000,0.28200,0.11000,0.14000,0.13500,0.13920,0.16950,0.14450,0.31620,0.32795,0.23310,0.24485,0.12620,0.13953,0.24525,0.25700,0.50900,0.16400];
        $this->sticker_dc[42000]	= [0.50100,0.33000,0.28200,0.28000,0.28200,0.11000,0.14000,0.13500,0.13920,0.16950,0.14450,0.31620,0.32795,0.23310,0.24485,0.12620,0.13953,0.24525,0.25700,0.50900,0.16400];
        $this->sticker_dc[43000]	= [0.50100,0.33000,0.28200,0.28000,0.28200,0.11000,0.14000,0.13500,0.13920,0.16950,0.14450,0.31620,0.32795,0.23310,0.24485,0.12620,0.13953,0.24525,0.25700,0.50900,0.16400];
        $this->sticker_dc[44000]	= [0.50100,0.33000,0.28200,0.28000,0.28200,0.11000,0.14000,0.13500,0.13920,0.16950,0.14450,0.31620,0.32795,0.23310,0.24485,0.12620,0.13953,0.24525,0.25700,0.50900,0.16400];
        $this->sticker_dc[45000]	= [0.50100,0.33000,0.28200,0.28000,0.28200,0.11000,0.14000,0.13500,0.13920,0.16950,0.14450,0.31620,0.32795,0.23310,0.24485,0.12620,0.13953,0.24525,0.25700,0.50900,0.16400];
        $this->sticker_dc[46000]	= [0.50100,0.33000,0.28200,0.28000,0.28200,0.11000,0.14000,0.13500,0.13920,0.16950,0.14450,0.31620,0.32795,0.23310,0.24485,0.12620,0.13953,0.24525,0.25700,0.50900,0.16400];
        $this->sticker_dc[47000]	= [0.50100,0.33000,0.28200,0.28000,0.28200,0.11000,0.14000,0.13500,0.13920,0.16950,0.14450,0.31620,0.32795,0.23310,0.24485,0.12620,0.13953,0.24525,0.25700,0.50900,0.16400];
        $this->sticker_dc[48000]	= [0.50100,0.33000,0.28200,0.28000,0.28200,0.11000,0.14000,0.13500,0.13920,0.16950,0.14450,0.31620,0.32795,0.23310,0.24485,0.12620,0.13953,0.24525,0.25700,0.50900,0.16400];
        $this->sticker_dc[49000]	= [0.50100,0.33000,0.28200,0.28000,0.28200,0.11000,0.14000,0.13500,0.13920,0.16950,0.14450,0.31620,0.32795,0.23310,0.24485,0.12620,0.13953,0.24525,0.25700,0.50900,0.16400];
        $this->sticker_dc[50000]	= [0.50000,0.32000,0.27000,0.27000,0.27000,0.11000,0.14000,0.13500,0.13920,0.16950,0.14450,0.31620,0.32795,0.23310,0.24485,0.12620,0.13953,0.24525,0.25700,0.50900,0.16400];
        $this->sticker_dc[55000]	= [0.51200,0.32300,0.27700,0.27300,0.27700,0.11200,0.14200,0.13700,0.14100,0.17300,0.14700,0.31900,0.33000,0.23500,0.24700,0.12900,0.14200,0.24800,0.25900,0.51300,0.16600];
        $this->sticker_dc[60000]	= [0.51900,0.32200,0.27400,0.27200,0.27400,0.11200,0.14200,0.13800,0.14100,0.17300,0.14600,0.31500,0.32700,0.23300,0.24500,0.12900,0.14200,0.24500,0.25700,0.51500,0.16700];
        $this->sticker_dc[65000]	= [0.52100,0.32200,0.27600,0.27200,0.27600,0.11200,0.14200,0.13800,0.14100,0.17300,0.14600,0.31600,0.32800,0.23400,0.24500,0.12900,0.14200,0.24600,0.25800,0.51500,0.16700];
        $this->sticker_dc[70000]	= [0.51900,0.32300,0.27700,0.27300,0.27700,0.11300,0.14200,0.13700,0.14100,0.17200,0.14600,0.31600,0.32800,0.23300,0.24500,0.12600,0.14000,0.24500,0.25700,0.51400,0.16700];
        $this->sticker_dc[75000]	= [0.51600,0.32300,0.27800,0.27300,0.27800,0.11300,0.14100,0.13600,0.14000,0.17100,0.14500,0.31600,0.32800,0.23300,0.24500,0.12600,0.14000,0.24500,0.25700,0.51200,0.16600];
        $this->sticker_dc[80000]	= [0.50900,0.32400,0.27900,0.27400,0.27900,0.11000,0.14100,0.13500,0.13900,0.17000,0.14500,0.31600,0.32800,0.23300,0.24500,0.12600,0.14000,0.24500,0.25700,0.50900,0.16400];
        $this->sticker_dc[85000]	= [0.50200,0.32400,0.28000,0.27400,0.28000,0.11000,0.14000,0.13500,0.13900,0.17000,0.14500,0.31600,0.32800,0.23300,0.24500,0.12600,0.14000,0.24500,0.25700,0.50900,0.16400];
        $this->sticker_dc[90000]	= [0.50000,0.32400,0.28100,0.27400,0.28100,0.11000,0.14000,0.13500,0.13900,0.17000,0.14500,0.31600,0.32800,0.23300,0.24500,0.12600,0.14000,0.24500,0.25700,0.50900,0.16400];
        $this->sticker_dc[95000]	= [0.50000,0.32500,0.27600,0.27500,0.27600,0.11000,0.14000,0.13500,0.13900,0.17000,0.14500,0.31600,0.32800,0.23300,0.24500,0.12600,0.14000,0.24500,0.25700,0.50900,0.16400];
        $this->sticker_dc[100000]   = [0.50000,0.32000,0.27000,0.27000,0.27000,0.11000,0.14000,0.13500,0.13900,0.17000,0.14500,0.31600,0.32800,0.23300,0.24500,0.12600,0.14000,0.24500,0.25700,0.50900,0.16400];
    }

    /**
     * @brief 재단형 스티커 비규격 가격 계산
     *
     * @param $param = 계산용 파라미터
     * @detail 가로/세로사이즈, 수량, 직전가격
     *
     * @return 계산된 가격
     */
    public function stCalcPrice($param): float {
        $conn = $this->conn;
        $dao  = $this->dao;

        $is_calc = true;
        $cate_sortcode = $param["cate_sortcode"];
        $st_bg         = $param["st_bg"];
        $paper_info    = explode(' ', $param["paper_info"]);

        // 스티커 최소가격 검색
        $temp = [];
        $temp["cate_sortcode"] = $cate_sortcode;
        $temp["paper_mpcode"] = $param['paper_mpcode'];
        //$conn->debug = 1;
        $stan_code = $dao->selectMinStan($conn, $temp);
        if($param["st_bg"] == "투터치재단") {
            $param["st_bg"] = "원터치재단";
        }
        $temp["stan_mpcode"] = $dao->selectMinStan($conn, $temp)[$param["st_bg"]];
        $min_amt = $dao->selectMinAmt($conn, $temp);

        $temp["amt"] = $param["amt"];
        $price = $dao->selectMinPrice($conn, $temp);
        $wid   = intval($param["wid"]); 
        $vert  = intval($param["vert"]); 
        $amt   = intval($param['amt']); 
        $grade_sale = doubleval($param["grade_sale"]) / -100.0;

        if ($cate_sortcode === "004001001") {
            if($param["paper_info"] == "아트지 강접 백색 90g") {
                // 강접 코팅/무코팅 스티커 각기
                if ($amt <= 1000) {
                    $per = 0.31;
                } else if ($amt > 1000 && $amt < 5000) {
                    $per = 0.29;
                } else if ($amt === 5000) {
                    $per = 0.275;
                } else if ($amt > 5000 && $amt < 10000) {
                    $per = 0.26;
                } else if ($amt === 10000) {
                    $per = 0.25;
                } else if ($amt > 10000 && $amt < 50000) {
                    $per = 0.24;
                } else if ($amt > 50000) {
                    $per = 0.235;
                }
            } else {
                if (strpos("크라프트", $paper_info[0]) !== false) {
                    if ($amt <= 1000) {
                        $per = 0.4;
                    } else if ($amt > 1000 && $amt < 5000){
                        $per = 0.39;
                    } else if ($amt === 5000){
                        $per  = 0.38;
                    } else if ($amt > 5000 && $amt < 10000){
                        $per  = 0.365;
                    } else if ($amt === 10000){
                        $per  = 0.35;
                    } else if ($amt > 10000 && $amt < 50000){
                        $per  = 0.345;
                    } else if ($amt >= 50000){
                        $per = 0.34;
                    }
                } else if (strpos("모조지", $paper_info[0]) !== false) {
                    if ($amt <= 1000) {
                        $per = 0.35;
                    } else if ($amt > 1000 && $amt < 5000){
                        $per = 0.345;
                    } else if ($amt === 5000){
                        $per  = 0.34;
                    } else if ($amt > 5000 && $amt < 10000){
                        $per  = 0.335;
                    } else if ($amt === 10000){
                        $per  = 0.315;
                    } else if ($amt > 10000 && $amt < 50000){
                        $per  = 0.3;
                    } else if ($amt >= 50000){
                        $per = 0.29;
                    }
                } else if(strpos("투명데드롱", $paper_info[0]) !== false){
                    if ($amt <= 1000) {
                        $per = 0.595;
                    } else if ($amt > 1000 && $amt < 5000){
                        $per = 0.59;
                    } else if ($amt === 5000){
                        $per  = 0.585;
                    } else if ($amt > 5000 && $amt < 10000){
                        $per  = 0.58;
                    } else if ($amt === 10000){
                        $per  = 0.57;
                    } else if ($amt > 10000 && $amt < 50000){
                        $per  = 0.565;
                    } else if ($amt >= 50000){
                        $per = 0.56;
                    }
                } else if(strpos("유포지", $paper_info[0]) !== false){
                    if ($amt <= 1000) {
                        $per = 0.54;
                    } else if ($amt > 1000 && $amt < 5000){
                        $per = 0.50;
                    } else if ($amt === 5000){
                        $per  = 0.45;
                    } else if ($amt > 5000 && $amt < 10000){
                        $per  = 0.43;
                    } else if ($amt === 10000){
                        $per  = 0.42;
                    } else if ($amt > 10000 && $amt < 50000){
                        $per  = 0.41;
                    } else if ($amt >= 50000){
                        $per = 0.40;
                    }
                } else if(strpos("은무데드롱", $paper_info[0]) !== false){
                    if ($amt <= 1000) {
                        $per = 0.88;
                    } else if ($amt > 1000 && $amt < 5000){
                        $per = 0.84;
                    } else if ($amt === 5000){
                        $per  = 0.8;
                    } else if ($amt > 5000 && $amt < 10000){
                        $per  = 0.75;
                    } else if ($amt === 10000){
                        $per  = 0.68;
                    } else if ($amt > 10000 && $amt < 50000){
                        $per  = 0.65;
                    } else if ($amt >= 50000){
                        $per = 0.64;
                    }
                } else {
                    if ($amt <= 1000) {
                        $per = 0.3;
                    } else if ($amt > 1000 && $amt < 5000){
                        $per = 0.3;
                    } else if ($amt === 5000){
                        $per  = 0.28;
                    } else if ($amt > 5000 && $amt < 10000){
                        $per  = 0.26;
                    } else if ($amt === 10000){
                        $per  = 0.24;
                    } else if ($amt > 10000 && $amt < 50000){
                        $per  = 0.24;
                    } else if ($amt >= 50000){
                        $per = 0.22;
                    }
                }
            }

            if ($st_bg === "원터치재단"){
                $area = ($wid * $vert / 100);
            } else if ($st_bg === "투터치재단"){
                $area = (($wid + 6) * ($vert + 6) / 100);
                //$price *= 1.1;
            }

            if($area < 33)
                $area = 33;
            if($amt == 500) $amt = 800;
            $area = $area * (0.78 - log10($area) / log10(3000000));
            //$area *= 0.88;
            $ret = $area * $per * $amt;
            //if($price > $ret){
            //    $is_calc = false;
            //    $ret = $price;
            //}
            if ($is_calc && $grade_sale !== 0.0) {
                // ret를 그대로 보내면 계산된 가격에서 등급할인을 하기 때문에
                // 등급할인 하기 전에 해당 금액만큼 뻥튀기
                $rate = $ret / ($ret * $grade_sale);
                $ret *= $rate;
            }
        } else {
            $ret = $price;
        }

        return $ret;
    }

    /**
     * @brief 재단형 스티커 비규격 가격 계산
     *
     * @param $param = 계산용 파라미터
     * @detail 가로/세로사이즈, 수량, 직전가격
     *
     * @return 계산된 가격
     */
    public function stCalcPriceTemp($param): float {
        $conn = $this->conn;
        $dao  = $this->dao;

        $is_calc = true;
        $cate_sortcode = $param["cate_sortcode"];
        $st_bg         = $param["st_bg"];
        $paper_info    = explode(' ', $param["paper_info"]);

        // 스티커 최소가격 검색
        $temp = [];
        $temp["cate_sortcode"] = $cate_sortcode;
        $temp["paper_mpcode"] = $param['paper_mpcode'];
        //$conn->debug = 1;
        $stan_code = $dao->selectMinStan($conn, $temp);
        if($param["st_bg"] == "투터치재단") {
            $param["st_bg"] = "원터치재단";
        }
        $temp["stan_mpcode"] = $dao->selectMinStan($conn, $temp)[$param["st_bg"]];
        $min_amt = $dao->selectMinAmt($conn, $temp);

        $temp["amt"] = $param["amt"];
        $price = $dao->selectMinPrice($conn, $temp);
        $wid   = intval($param["wid"]);
        $vert  = intval($param["vert"]);
        $amt   = intval($param['amt']);
        $grade_sale = doubleval($param["grade_sale"]) / -100.0;

        if ($cate_sortcode === "004001001") {
            if($param["paper_info"] == "아트지 강접 백색 90g") {
                // 강접 코팅/무코팅 스티커 각기
                if ($amt <= 500) {
                    $per = 0.296;
                } else if ($amt == 1000) {
                    $per = 0.175;
                } else if ($amt > 1000 && $amt < 5000) {
                    $per = 0.157;
                } else if ($amt >= 5000 && $amt <= 6000) {
                    $per = 0.151;
                } else if ($amt > 6000 && $amt <= 20000) {
                    $per = 0.135;
                } else if ($amt >= 30000) {
                    $per = 0.123;
                }
            } else {
                if (strpos("크라프트", $paper_info[0]) !== false) {
                    if ($amt <= 500) {
                        $per = 0.418;
                    } else if ($amt >= 1000 && $amt <= 2000) {
                        $per = 0.246;
                    } else if ($amt <= 3000) {
                        $per = 0.238;
                    } else if ($amt <= 4000) {
                        $per = 0.233;
                    } else if ($amt <= 5000) {
                        $per = 0.229;
                    } else if ($amt <= 6000) {
                        $per = 0.224;
                    } else if ($amt <= 7000) {
                        $per = 0.22;
                    } else if ($amt <= 8000) {
                        $per = 0.216;
                    } else if ($amt <= 9000) {
                        $per = 0.211;
                    } else if ($amt <= 10000) {
                        $per = 0.21;
                    } else if ($amt <= 11000) {
                        $per = 0.208;
                    } else if ($amt <= 12000) {
                        $per = 0.207;
                    } else if ($amt <= 13000) {
                        $per = 0.207;
                    } else if ($amt <= 14000) {
                        $per = 0.206;
                    } else if ($amt <= 15000) {
                        $per = 0.204;
                    } else if ($amt <= 16000) {
                        $per = 0.203;
                    } else if ($amt <= 17000) {
                        $per = 0.202;
                    } else if ($amt <= 18000) {
                        $per = 0.2;
                    } else if ($amt <= 19000) {
                        $per = 0.199;
                    } else if ($amt <= 20000) {
                        $per = 0.198;
                    } else if ($amt <= 30000) {
                        $per = 0.186;
                    }
                } else if (strpos("모조지", $paper_info[0]) !== false) {
                    if ($amt <= 500) {
                        $per = 0.318;
                    } else if ($amt <= 1000) {
                        $per = 0.188;
                    } else if ($amt <= 2000) {
                        $per = 0.185;
                    } else if ($amt <= 3000) {
                        $per = 0.183;
                    } else if ($amt <= 4000) {
                        $per = 0.18;
                    } else if ($amt <= 5000) {
                        $per = 0.179;
                    } else if ($amt <= 6000) {
                        $per = 0.176;
                    } else if ($amt <= 7000) {
                        $per = 0.174;
                    } else if ($amt <= 8000) {
                        $per = 0.172;
                    } else if ($amt <= 9000) {
                        $per = 0.169;
                    } else if ($amt <= 10000) {
                        $per = 0.167;
                    } else if ($amt <= 12000) {
                        $per = 0.166;
                    } else if ($amt <= 14000) {
                        $per = 0.165;
                    } else if ($amt <= 16000) {
                        $per = 0.164;
                    } else if ($amt <= 18000) {
                        $per = 0.163;
                    } else if ($amt <= 20000) {
                        $per = 0.162;
                    } else if ($amt <= 30000) {
                        $per = 0.156;
                    } else if ($amt <= 100000) {
                        $per = 0.154;
                    }
                } else if(strpos("투명데드롱", $paper_info[0]) !== false){
                    if ($amt <= 500) {
                        $per = 0.614;
                    } else if ($amt <= 1000) {
                        $per = 0.352;
                    } else if ($amt <= 4000) {
                        $per = 0.341;
                    } else if ($amt <= 5000) {
                        $per = 0.33;
                    } else if ($amt <= 9000) {
                        $per = 0.319;
                    } else if ($amt <= 40000) {
                        $per = 0.308;
                    } else if ($amt <= 100000) {
                        $per = 0.297;
                    }
                } else if(strpos("유포지", $paper_info[0]) !== false){
                    if ($amt <= 500) {
                        $per = 0.546;
                    } else if ($amt <= 1000) {
                        $per = 0.316;
                    } else if ($amt <= 2000) {
                        $per = 0.315;
                    } else if ($amt <= 3000) {
                        $per = 0.295;
                    } else if ($amt <= 4000) {
                        $per = 0.29;
                    } else if ($amt <= 5000) {
                        $per = 0.284;
                    } else if ($amt <= 6000) {
                        $per = 0.279;
                    } else if ($amt <= 7000) {
                        $per = 0.273;
                    } else if ($amt <= 8000) {
                        $per = 0.268;
                    } else if ($amt <= 9000) {
                        $per = 0.262;
                    } else if ($amt <= 20000) {
                        $per = 0.257;
                    } else if ($amt <= 100000) {
                        $per = 0.256;
                    }
                } else if(strpos("은무데드롱", $paper_info[0]) !== false){
                    if ($amt <= 500) {
                        $per = 0.739;
                    } else if ($amt <= 1000) {
                        $per = 0.433;
                    } else if ($amt <= 4000) {
                        $per = 0.404;
                    } else if ($amt <= 5000) {
                        $per = 0.378;
                    } else if ($amt <= 9000) {
                        $per = 0.35;
                    } else if ($amt <= 40000) {
                        $per = 0.323;
                    } else if ($amt <= 100000) {
                        $per = 0.309;
                    }
                } else {
                    if ($amt <= 1000) {
                        $per = 0.3;
                    } else if ($amt > 1000 && $amt < 5000){
                        $per = 0.3;
                    } else if ($amt === 5000){
                        $per  = 0.28;
                    } else if ($amt > 5000 && $amt < 10000){
                        $per  = 0.26;
                    } else if ($amt === 10000){
                        $per  = 0.24;
                    } else if ($amt > 10000 && $amt < 50000){
                        $per  = 0.24;
                    } else if ($amt >= 50000){
                        $per = 0.22;
                    }
                }
            }

            if ($st_bg === "원터치재단"){
                $area = ($wid * $vert / 100);
            } else if ($st_bg === "투터치재단"){
                $area = (($wid + 6) * ($vert + 6) / 100);
                //$price *= 1.1;
            }

            if($area < 33)
                $area = 33;
            //if($amt == 500) $amt = 800;
            //$area = $area * (0.78 - log10($area) / log10(3000000));
            //$area *= 0.88;
            $ret = $area * $per * $amt;
            //if($price > $ret){
            //    $is_calc = false;
            //    $ret = $price;
            //}
            if ($is_calc && $grade_sale !== 0.0) {
                // ret를 그대로 보내면 계산된 가격에서 등급할인을 하기 때문에
                // 등급할인 하기 전에 해당 금액만큼 뻥튀기
                $rate = $ret / ($ret * $grade_sale);
                $ret *= $rate;
            }
        } else {
            $ret = $price;
        }

        return $ret;
    }

    /**
     * @brief 재단형 스티커 비규격 가격 계산
     *
     * @param $param = 계산용 파라미터
     * @detail 가로/세로사이즈, 수량, 직전가격
     *
     * @return 계산된 가격
     */
    public function stCalcPriceNew($param): float {
        $cate_sortcode = $param["cate_sortcode"];
        $esize1 = $csize1 = intval($param["wid"]);
        $esize2 = $csize2 = intval($param["vert"]);
        //echo $esize2;
        $bg_sk = $param["st_bg"];
        $busu = $param["amt"];
        $paper_mpcode = $param['paper_mpcode'];
//echo $paper_mpcode;
        $paper_idx = 0;
        switch ($paper_mpcode) {
            case 223:
            case 237:
            case 1544:
            case 1593:
                $paper_idx = 5;// 아트지
                break;
            case 1546:
                $paper_idx = 8;// 아트지 강접
                break;
            case 1545:
                $paper_idx = 7;// 아트지 초강접
                break;
            case 225:
            case 240:
            case 1542:
            case 1594:
                $paper_idx = 13; // 유포지
                break;
            case 228:
            case 241:
            case 1538:
            case 1584:
                $paper_idx = 6; // 모조지
                break;
            case 226:
            case 239:
            case 1540:
            case 1585:
                $paper_idx = 3; // 투명데드롱
                break;
            case 224:
            case 238:
            case 1539:
                $paper_idx = 2; // 은색데드롱
                break;
            case 227:
            case 242:
            case 1537:
            case 1583:
                $paper_idx = 9; // 크라프트
                break;
            case 1547:
                $paper_idx = 11; // PVC무코팅
                break;
            case 1543:
                $paper_idx = 15; // 리무버블 아트지
                break;
            case 1541:
                $paper_idx = 18; // 리무버블 유포지
                break;
            case 1548:
            case 1588:
            case 1592:
            case 1586:
            case 1589:
            case 1587:
            case 1591:
                $paper_idx = 19; // 홀로그램
                break;
        }

        $rs_dc = $this->sticker_dc[$busu][$paper_idx];
//echo $paper_idx;
        if($param["st_bg"] != "원터치재단") {
            $esize1 += 6;
            $esize2 += 6;
        }

        switch($paper_mpcode)
        {
            case /*"아트지 90g (코팅)"*/ 223			:	$min_print = ($busu == 500)? "3400" : "5000"; $cvt_paper = "아트지 90g"; break;
            case /*"아트지 90g (코팅)"*/ 1544			:	$min_print = ($busu == 500)? "3400" : "5000"; $cvt_paper = "아트지 90g"; break;
            case /*"아트지 90g (코팅)"*/ 1593			:	$min_print = ($busu == 500)? "3400" : "5000"; $cvt_paper = "아트지 90g"; break;
            case /*"아트지 90g (비코팅)"*/ 237		:	$min_print = ($busu == 500)? "3400" : "5000"; $cvt_paper = "아트지 90g"; break;
            case "아트지 90g (무광코팅)"				:	$min_print = ($busu == 500)? "3700" : "5000"; $cvt_paper = "아트지 90g"; break;
            case /*"아트지 90g (코팅강력접착)"*/ 1546	:	$min_print = ($busu == 500)? "3900" : "5500"; $cvt_paper = "아트지 90g (강접)"; break;
            case "아트지 90g (비코팅강력접착)"			:	$min_print = ($busu == 500)? "3900" : "5500"; $cvt_paper = "아트지 90g (강접)"; break;
            case "아트지 90g (코팅초강력접착)"			:	$min_print = ($busu == 500)? "4500" : "6000"; $cvt_paper = "아트지 90g (초강접)"; break;
            case /*"아트지 90g (코팅초강력접착)"*/ 1545	:	$min_print = ($busu == 500)? "4500" : "6000"; $cvt_paper = "아트지 90g (초강접)"; break;
            case "아트지 90g (비코팅초강력접착)"		:	$min_print = ($busu == 500)? "4500" : "6000"; $cvt_paper = "아트지 90g (초강접)"; break;
            case "아트지 90g (무광코팅 초강력 접착)"	:	$cvt_paper = "아트지 90g (무광코팅 초강력 접착)"; break;
            case "유포지 80g"						:	$min_print = ($busu == 500)? "8000" : "10800"; $cvt_paper = "유포지 80g (비코팅)"; break;
            case /*"유포지 80g (무광코팅)"*/ 225		:	$min_print = ($busu == 500)? "8100" : "10800"; $cvt_paper = "유포지 80g (무광코팅)"; break;
            case /*"유포지 80g (무광코팅)"*/ 240		:	$min_print = ($busu == 500)? "8100" : "10800"; $cvt_paper = "유포지 80g (무광코팅)"; break;
            case /*"유포지 80g (무광코팅)"*/ 1542		:	$min_print = ($busu == 500)? "8100" : "10800"; $cvt_paper = "유포지 80g (무광코팅)"; break;
            case /*"유포지 80g (무광코팅)"*/ 1594		:	$min_print = ($busu == 500)? "8100" : "10800"; $cvt_paper = "유포지 80g (무광코팅)"; break;
            case /*"모조지 80g"*/228					:	$min_print = "3900";  break;
            case /*"모조지 80g"*/241					:	$min_print = "3900";  break;
            case /*"모조지 80g"*/1538				:	$min_print = "3900";  break;
            case /*"모조지 80g"*/1584				:	$min_print = "3900";  break;
            case /*"투명 데드롱 50g"*/226				:	$min_print = ($busu == 500)? "8700" : "10400";  break;
            case /*"투명 데드롱 50g"*/239				:	$min_print = ($busu == 500)? "8700" : "10400";  break;
            case /*"투명 데드롱 50g"*/1540			:	$min_print = ($busu == 500)? "8700" : "10400";  break;
            case /*"은색 데드롱 50g"*/224				:	$min_print = ($busu == 500)? "9500" : "12700";  break;
            case /*"은색 데드롱 50g"*/238				:	$min_print = ($busu == 500)? "9500" : "12700";  break;
            case /*"은색 데드롱 50g"*/1539			:	$min_print = ($busu == 500)? "9500" : "12700";  break;
            case /*"PVC 120g"*/1547					:	$min_print = ($busu == 500)? "9200" : "14000"; $cvt_paper = "PVC 120g (비코팅)"; break;
            case "PVC 120g (유광코팅)"				:	$min_print = ($busu == 500)? "9400" : "14000"; $cvt_paper = "PVC 120g (유광코팅)"; break;
            case /*"크라프트지 57g"*/227				:	$min_print = ($busu == 500)? "5400" : "6700";  $cvt_paper = "크라프트지 57g"; break;
            case /*"크라프트지 57g"*/242				:	$min_print = ($busu == 500)? "5400" : "6700";  $cvt_paper = "크라프트지 57g"; break;
            case /*"크라프트지 57g"*/1537				:	$min_print = ($busu == 500)? "5400" : "6700";  $cvt_paper = "크라프트지 57g"; break;
            case /*"크라프트지 57g"*/1583				:	$min_print = ($busu == 500)? "5400" : "6700";  $cvt_paper = "크라프트지 57g"; break;
            case "데드롱38g (주차증)"					:	$min_print = "15000"; break;
            case "랜덤 A"							:	$cvt_paper = "아트지 90g"; break;
            case "랜덤 B"							:	$cvt_paper = "투명 데드롱 50g"; break;
            case "랜덤 C"							:	$cvt_paper = "아트지 90g"; break; // 2020.08.28
            case /*"리무버블 아트지 90g (유광코팅)"*/1543 :	$min_print = ($busu == 500)? "5000" : "6400"; $cvt_paper = "리무버블 아트지 90g (유광코팅)"; break;
            case /*"리무버블 유포지 80g (무광코팅)"*/1541 :	$min_print = ($busu == 500)? "8800" : "12000"; $cvt_paper = "리무버블 유포지 80g (무광코팅)"; break;
            case /*"홀로그램(민무늬) 50µ"*/1548				:	$min_print = "30000"; $cvt_paper = "홀로그램(민무늬) 50µ"; break;
            case /*"홀로그램(민무늬) 50µ"*/1592				:	$min_print = "30000"; $cvt_paper = "홀로그램(민무늬) 50µ"; break;
            case /*"홀로그램(민무늬) 50µ"*/1588				:	$min_print = "30000"; $cvt_paper = "홀로그램(민무늬) 50µ"; break;
            case /*"홀로그램(민무늬) 50µ"*/1586				:	$min_print = "30000"; $cvt_paper = "홀로그램(민무늬) 50µ"; break;
            case /*"홀로그램(민무늬) 50µ"*/1589				:	$min_print = "30000"; $cvt_paper = "홀로그램(민무늬) 50µ"; break;
            case /*"홀로그램(민무늬) 50µ"*/1587				:	$min_print = "30000"; $cvt_paper = "홀로그램(민무늬) 50µ"; break;
            case /*"홀로그램(민무늬) 50µ"*/1591				:	$min_print = "30000"; $cvt_paper = "홀로그램(민무늬) 50µ"; break;
            //case /*"홀로그램(민무늬) 50µ"*/1548				:	$min_print = ($name_skin == '사각재단스티커')? "27000" : "30000"; $cvt_paper = "홀로그램(민무늬) 50µ"; break;
        }

        if($cvt_paper == '아트지 90g (강접)' || $cvt_paper == '크라프트지 57g' || $cvt_paper == '아트지 90g (초강접)' || $cvt_paper == 'PVC 120g' || $cvt_paper == 'PVC 120g (유광코팅)' || $cvt_paper == '유포지 80g' || $cvt_paper == '유포지 80g (무광코팅)' || $cvt_paper == '리무버블 아트지 90g (유광코팅)' || $cvt_paper == '리무버블 유포지 80g (무광코팅)') {
            $price_x			=	$esize1 / 10;
            $price_y			=	$esize2 / 10;
        } else if($cvt_paper == '홀로그램(민무늬) 50µ') {
            $price_x			=	(($esize1 / 10) <= 9.1 ? 9.1 : $esize1 / 10);
            $price_y			=	(($esize2 / 10) <= 5.7 ? 5.7 : $esize2 / 10);
        } else {
            $price_x			=	(($esize1 / 10) <= 5.7 ? 5.7 : $esize1 / 10);
            $price_y			=	(($esize2 / 10) <= 5.7 ? 5.7 : $esize2 / 10);
        }

        if($cvt_paper == '아트지 90g')
        {
            $msx				=	0;
            $msy				=	0;
            if($bg_sk != "원터치재단"){
                $msx			=	(($price_x - 0.2) <= 5.7 ? 0 : 0.2);
                $msy			=	(($price_y - 0.2) <= 5.7 ? 0 : 0.2);
            }
            //2015.10.16.방준혁 - 박현배팀장요청
            $p_base				=	round(($price_x - $msx) * ($price_y - $msy) * $busu * $rs_dc * 102 / 100, -2);
            //$p_base				=	(5000 > $p_base ? 5000 : $p_base);
            //2015.10.16.방준혁 - 박현배팀장요청
//echo $price_x . " x" . $price_y;
            $p_base				=	($min_print > $p_base ? $min_print : $p_base);

            if($cvt_paper == '아트지 90g (무광코팅)') {
                $p_base			=	$p_base + ($busu / 1000) * 500;
            }
        }
        else if($cvt_paper == '크라프트지 57g')
        {
            if($_POST['jCut'] == 'Y') {
                $width				=	min($_POST['jsize1']/10, $_POST['jsize2']/10);
                $height				=	max($_POST['jsize1']/10, $_POST['jsize2']/10);
            } else {
                $width				=	min($csize1/10, $csize2/10);
                $height				=	max($csize1/10, $csize2/10);
            }
//echo "width : " . $width . " height : " . $height;
            if($width >= 1 && $width <= 4 && $height <= 12) {
                if($bg_sk != "원터치재단") {
                    $rs_dc	=	$rs_dc + 0.064;
                } else {
                    $rs_dc	=	$rs_dc + 0.112;
                }
            } else if($width >= 1 && $width <= 4 && $height > 12) {
                if($bg_sk != "원터치재단") {
                    $rs_dc	=	$rs_dc + 0.072;
                } else {
                    $rs_dc	=	$rs_dc + 0.119;
                }
            } else if($width > 4 && $width <= 5 && $height <= 13) {
                if($bg_sk != "원터치재단") {
                    $rs_dc	=	$rs_dc + 0.015;
                } else {
                    $rs_dc	=	$rs_dc + 0.045;
                }
            } else if($width > 4 && $width <= 5 && $height > 13) {
                if($bg_sk != "원터치재단") {
                    $rs_dc	=	$rs_dc + 0.019;
                } else {
                    $rs_dc	=	$rs_dc + 0.05;
                }
            } else if($width > 5 && $width <= 6 && $height <= 11) {
                if($bg_sk != "원터치재단") {
                    $rs_dc	=	$rs_dc - 0.008;
                } else {
                    $rs_dc	=	$rs_dc + 0.003;
                }
            } else if($width > 5 && $width <= 6 && $height > 11) {
                if($bg_sk != "원터치재단") {
                    $rs_dc	=	$rs_dc - 0.003;
                } else {
                    $rs_dc	=	$rs_dc;
                }
            } else if($width > 6) {
                if($bg_sk != "원터치재단") {
                    $rs_dc	=	$rs_dc - 0.003;
                } else {
                    $rs_dc	=	$rs_dc;
                }
            }

            //$p_base			=	round($width * $height * $busu * $rs_dc, -2);
            if($bg_sk != "원터치재단"){
                $p_base			=	round(($width + 0.6) * ($height + 0.6) * $busu * $rs_dc, -2);
                //$p_base		=	ceil(($width + 0.6) * ($height + 0.6) * $busu * $rs_dc);
            } else {
                $p_base			=	round($width * $height * $busu * $rs_dc, -2);
                //$p_base		=	ceil($width * $height * $busu * $rs_dc);
            }
        }
        else if($cvt_paper == '아트지 90g (코팅강력접착)' || $cvt_paper == '아트지 90g (비코팅강력접착)')
        {
            if($_POST['jCut'] == 'Y') {
                $width				=	min($_POST['jsize1']/10, $_POST['jsize2']/10);
                $height				=	max($_POST['jsize1']/10, $_POST['jsize2']/10);
            } else {
                $width				=	min($csize1/10, $csize2/10);
                $height				=	max($csize1/10, $csize2/10);
            }

            if($width >= 1 && $width <= 4 && $busu <= 6000) {
                if($bg_sk != "원터치재단") {
                    $rs_dc	=	$rs_dc + 0.0369;
                } else {
                    $rs_dc	=	$rs_dc + 0.0682;
                }
            } else if($width >= 1 && $width <= 4 && $busu > 6000 && $busu <= 10000) {
                if($bg_sk != "원터치재단") {
                    $rs_dc	=	$rs_dc + 0.048;
                } else {
                    $rs_dc	=	$rs_dc + 0.085;
                }
            } else if($width >= 1 && $width <= 4 && $busu > 10000 && $busu <= 28000) {
                if($bg_sk != "원터치재단") {
                    if($busu == 11000) {
                        $rs_dc	=	$rs_dc + 0.0492;
                    } else {
                        $rs_dc	=	$rs_dc + (0.0492 - (substr($busu,0,2) - 11) * 0.0008);
                    }
                } else {
                    $rs_dc		=	$rs_dc + (0.085 - (substr($busu,0,2) - 10) * 0.0008);
                }
            } else if($width >= 1 && $width <= 4 && $busu > 28000) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc + 0.0356;
                } else {
                    $rs_dc		=	$rs_dc + 0.0706;
                }
            } else if($width > 4 && $width <= 5 && $busu <= 6000) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc + 0.008;
                } else {
                    $rs_dc		=	$rs_dc + 0.0188;
                }
            } else if($width > 4 && $width <= 5 && $busu > 6000 && $busu <= 10000) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc + 0.008;
                } else {
                    $rs_dc		=	$rs_dc + 0.035;
                }
            } else if($width > 4 && $width <= 5 && $busu > 10000 && $busu <= 28000) {
                if($bg_sk != "원터치재단") {
                    if($busu == 11000) {
                        $rs_dc	=	$rs_dc + 0.0115;
                    } else {
                        $rs_dc	=	$rs_dc + (0.0115 - (substr($busu,0,2) - 11) * 0.0006);
                    }
                } else {
                    $rs_dc		=	$rs_dc + (0.035 - (substr($busu,0,2) - 10) * 0.0006);
                }
            } else if($width > 4 && $width <= 5 && $busu > 28000) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc + 0.0008;
                } else {
                    $rs_dc		=	$rs_dc + 0.0242;
                }
            } else if($width > 5) {
                if($bg_sk != "원터치재단") {
                    if($busu <= 10000) {
                        $rs_dc	=	$rs_dc - 0.007;
                    } else {
                        $rs_dc	=	$rs_dc - 0.005;
                    }
                } else {
                    $rs_dc		=	$rs_dc;
                }
            }

            $price_x				=	($price_x < 4.15)? 4.15 : $price_x;
            $price_y				=	($price_y < 4.15)? 4.15 : $price_y;

            $p_base					=	ceil($price_x * $price_y * $busu * $rs_dc);
        }
        else if($cvt_paper == '아트지 90g (코팅초강력접착)' || $cvt_paper == '아트지 90g (비코팅초강력접착)')
        {
            if($_POST['jCut'] == 'Y') {
                $width				=	min($_POST['jsize1']/10, $_POST['jsize2']/10);
                $height				=	max($_POST['jsize1']/10, $_POST['jsize2']/10);
            } else {
                $width				=	min($csize1/10, $csize2/10);
                $height				=	max($csize1/10, $csize2/10);
            }

            if($width >= 1 && $width <= 4.7 && $height <= 9) {
                if($busu <= 5000) {
                    $rs_dc		=	$rs_dc + 0.0278;
                } else if($busu == 6000){
                    $rs_dc		=	$rs_dc + 0.0299;
                } else if($busu == 7000){
                    $rs_dc		=	$rs_dc + 0.048;
                } else if($busu == 8000){
                    $rs_dc		=	$rs_dc + 0.049;
                } else if($busu == 9000){
                    $rs_dc		=	$rs_dc + 0.0487;
                } else if($busu >= 10000 && $busu <= 13000) {
                    $rs_dc		=	$rs_dc + 0.0485;
                } else if($busu > 13000 && $busu <= 19000) {
                    $rs_dc		=	$rs_dc + 0.044;
                } else if($busu == 20000){
                    $rs_dc		=	$rs_dc + 0.0403;
                } else if($busu > 20000){
                    $rs_dc		=	$rs_dc + 0.0385;
                }
            } else if($width >= 1 && $width <= 4.7 && $height > 9) {
                if($busu <= 5000) {
                    $rs_dc		=	$rs_dc + 0.028;
                } else if($busu == 6000){
                    $rs_dc		=	$rs_dc + 0.03;
                } else if($busu == 7000){
                    $rs_dc		=	$rs_dc + 0.031;
                } else if($busu == 8000){
                    $rs_dc		=	$rs_dc + 0.032;
                } else if($busu == 9000){
                    $rs_dc		=	$rs_dc + 0.033;
                } else if($busu >= 10000 && $busu <= 13000){
                    $rs_dc		=	$rs_dc + 0.0327;
                } else if($busu >= 13000 && $busu <= 19000){
                    $rs_dc		=	$rs_dc + 0.0315;
                } else if($busu == 20000){
                    $rs_dc		=	$rs_dc + 0.0255;
                } else if($busu > 20000){
                    $rs_dc		=	$rs_dc + 0.0275;
                }
            } else if($width > 4.7 && $width <= 5 && $height <= 9) {
                if($busu <= 5000) {
                    $rs_dc		=	$rs_dc + 0.0163;
                } else if($busu == 6000){
                    $rs_dc		=	$rs_dc + 0.0215;
                } else if($busu == 7000){
                    $rs_dc		=	$rs_dc + 0.0355;
                } else if($busu == 8000){
                    $rs_dc		=	$rs_dc + 0.0375;
                } else if($busu == 9000){
                    $rs_dc		=	$rs_dc + 0.0372;
                } else if($busu >= 10000 && $busu <= 13000) {
                    $rs_dc		=	$rs_dc + 0.0375;
                } else if($busu > 13000 && $busu <= 19000) {
                    $rs_dc		=	$rs_dc + 0.0335;
                } else if($busu == 20000){
                    $rs_dc		=	$rs_dc + 0.0315;
                } else if($busu > 20000){
                    $rs_dc		=	$rs_dc + 0.0285;
                }
            } else if($width > 4.7 && $width <= 5 && $height > 9) {
                if($busu <= 5000) {
                    $rs_dc		=	$rs_dc + 0.0175;
                } else if($busu == 6000){
                    $rs_dc		=	$rs_dc + 0.02;
                } else if($busu == 7000){
                    $rs_dc		=	$rs_dc + 0.021;
                } else if($busu == 8000){
                    $rs_dc		=	$rs_dc + 0.022;
                } else if($busu == 9000){
                    $rs_dc		=	$rs_dc + 0.023;
                } else if($busu >= 10000 && $busu <= 13000) {
                    $rs_dc		=	$rs_dc + 0.021;
                } else if($busu > 13000 && $busu <= 19000) {
                    $rs_dc		=	$rs_dc + 0.019;
                } else if($busu == 20000){
                    $rs_dc		=	$rs_dc + 0.017;
                } else if($busu > 20000){
                    $rs_dc		=	$rs_dc + 0.013;
                }
            } else if($width > 5 && $width <= 25) {
                $rs_dc		=	$rs_dc;
            } else if($width > 25 && $width <= 30) {
                if($busu <= 5000) {
                    $rs_dc		=	$rs_dc;
                } else if($busu == 6000){
                    $rs_dc		=	$rs_dc - 0.0015;
                } else if($busu == 7000){
                    $rs_dc		=	$rs_dc - 0.001;
                } else if($busu == 8000){
                    $rs_dc		=	$rs_dc - 0.0005;
                } else if($busu >= 9000 && $busu <= 19000){
                    $rs_dc		=	$rs_dc;
                } else if($busu == 20000){
                    $rs_dc		=	$rs_dc - 0.0026;
                } else if($busu > 20000){
                    $rs_dc		=	$rs_dc + 0.0019;
                }
            } else if($width > 30) {
                if($busu <= 5000) {
                    $rs_dc		=	$rs_dc;
                } else if($busu == 6000){
                    $rs_dc		=	$rs_dc - 0.003;
                } else if($busu == 7000){
                    $rs_dc		=	$rs_dc - 0.0025;
                } else if($busu == 8000){
                    $rs_dc		=	$rs_dc - 0.002;
                } else if($busu >= 9000 && $busu <= 19000){
                    $rs_dc		=	$rs_dc - 0.0015;
                } else if($busu == 20000 ){
                    $rs_dc		=	$rs_dc - 0.0041;
                } else if($busu > 20000){
                    $rs_dc		=	$rs_dc + 0.0004;
                }
            }

            //$p_base			=	round(($width + 0.6) * ($height + 0.6) * $busu * $rs_dc, -2);
            //$p_base				=	ceil(($width + 0.6) * ($height + 0.6) * $busu * $rs_dc);
            $price_x				=	($price_x < 4.7)? 4.7 : $price_x;
            $price_y				=	($price_y < 4.7)? 4.7 : $price_y;

            $p_base					=	ceil($price_x * $price_y * $busu * $rs_dc);
        }
        else if($cvt_paper == 'PVC 120g' || $cvt_paper == 'PVC 120g (유광코팅)')
        {
            if($_POST['jCut'] == 'Y') {
                $width				=	min($_POST['jsize1']/10, $_POST['jsize2']/10);
                $height				=	max($_POST['jsize1']/10, $_POST['jsize2']/10);
            } else {
                $width				=	min($csize1/10, $csize2/10);
                $height				=	max($csize1/10, $csize2/10);
            }

            if($width >= 1 && $width <= 4 && $height <= 13) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc - 0.0113;
                } else {
                    $rs_dc		=	$rs_dc + 0.0003;
                }
            } else if($width >= 1 && $width <= 4 && $height > 13) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc - 0.0093;
                } else {
                    $rs_dc		=	$rs_dc - 0.0001;
                }
            } else if($width > 4 && $width <= 5 && $height <= 13) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc - 0.0093;
                } else {
                    $rs_dc		=	$rs_dc + 0.0007;
                }
            } else if($width > 4 && $width <= 5 && $height > 13) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc - 0.0079;
                } else {
                    $rs_dc		=	$rs_dc - 0.0001;
                }
            } else if($width > 5 && $width <= 6 && $height <= 11) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc - 0.0087;
                } else {
                    $rs_dc		=	$rs_dc + 0.0008;
                }
            } else if($width > 5 && $width <= 6 && $height > 11) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc - 0.0078;
                } else {
                    $rs_dc		=	$rs_dc;
                }
            } else if($width > 6) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc - 0.0078;
                } else {
                    $rs_dc		=	$rs_dc;
                }
            }

            //$p_base					=	round($width * $height * $busu * $rs_dc, -2);
            if($bg_sk != "원터치재단"){
                //$p_base					=	round(($width + 0.6) * ($height + 0.6) * $busu * $rs_dc, -2);
                $p_base					=	ceil(($width + 0.6) * ($height + 0.6) * $busu * $rs_dc);
            } else {
                //$p_base					=	round($width * $height * $busu * $rs_dc, -2);
                $p_base					=	ceil($width * $height * $busu * $rs_dc);
            }
        }
        else if($cvt_paper == '유포지 80g' || $cvt_paper == '유포지 80g (무광코팅)')
        {
            if($_POST['jCut'] == 'Y') {
                $width				=	min($_POST['jsize1']/10, $_POST['jsize2']/10);
                $height				=	max($_POST['jsize1']/10, $_POST['jsize2']/10);
            } else {
                $width				=	min($csize1/10, $csize2/10);
                $height				=	max($csize1/10, $csize2/10);
            }

            if($width >= 1 && $width <= 4 && $height <= 13) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc - 0.0076;
                } else {
                    $rs_dc		=	$rs_dc + 0.0019;
                }
            } else if($width >= 1 && $width <= 4 && $height > 13) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc - 0.0074;
                } else {
                    $rs_dc		=	$rs_dc + 0.0004;
                }
            } else if($width > 4 && $width <= 5 && $height <= 13) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc - 0.0076;
                } else {
                    $rs_dc		=	$rs_dc + 0.0004;
                }
            } else if($width > 4 && $width <= 5 && $height > 13) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc - 0.0066;
                } else {
                    $rs_dc		=	$rs_dc;
                }
            } else if($width > 5 && $width <= 6 && $height <= 11) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc - 0.0086;
                } else {
                    $rs_dc		=	$rs_dc + 0.0004;
                }
            } else if($width > 5 && $width <= 6 && $height > 11) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc - 0.0051;
                } else {
                    $rs_dc		=	$rs_dc;
                }
            } else if($width > 6) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc - 0.0051;
                } else {
                    $rs_dc		=	$rs_dc;
                }
            }

            //$p_base					=	round($width * $height * $busu * $rs_dc, -2);
            if($bg_sk != "원터치재단"){
                //$p_base					=	round(($width + 0.6) * ($height + 0.6) * $busu * $rs_dc, -2);
                $p_base					=	ceil(($width + 0.6) * ($height + 0.6) * $busu * $rs_dc);
            } else {
                //$p_base					=	round($width * $height * $busu * $rs_dc, -2);
                $p_base					=	ceil($width * $height * $busu * $rs_dc);
            }
        }
        else if($cvt_paper == '리무버블 아트지 90g (비코팅)' || $cvt_paper == '리무버블 아트지 90g (유광코팅)')
        {
            if($_POST['jCut'] == 'Y') {
                $width				=	min($_POST['jsize1']/10, $_POST['jsize2']/10);
                $height				=	max($_POST['jsize1']/10, $_POST['jsize2']/10);
            } else {
                $width				=	min($csize1/10, $csize2/10);
                $height				=	max($csize1/10, $csize2/10);
            }

            if($width >= 1 && $width <= 4 && $height <= 13) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc + 0.0489;
                } else {
                    $rs_dc		=	$rs_dc + 0.0755;
                }
            } else if($width >= 1 && $width <= 4 && $height > 13) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc + 0.0515;
                } else {
                    $rs_dc		=	$rs_dc + 0.0784;
                }
            } else if($width > 4 && $width <= 5 && $height <= 13) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc + 0.0222;
                } else {
                    $rs_dc		=	$rs_dc + 0.035;
                }
            } else if($width > 4 && $width <= 5 && $height > 13) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc + 0.0239;
                } else {
                    $rs_dc		=	$rs_dc + 0.038;
                }
            } else if($width > 5 && $width <= 6) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc + 0.0012;
                } else {
                    $rs_dc		=	$rs_dc + 0.0109;
                }
            } else if($width > 6) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc - 0.0062;
                } else {
                    $rs_dc		=	$rs_dc;
                }
            }

            //$p_base					=	round($width * $height * $busu * $rs_dc, -2);
            if($bg_sk != "원터치재단"){
                //$p_base					=	round(($width + 0.6) * ($height + 0.6) * $busu * $rs_dc, -2);
                $p_base					=	ceil(($width + 0.6) * ($height + 0.6) * $busu * $rs_dc);
            } else {
                //$p_base					=	round($width * $height * $busu * $rs_dc, -2);
                $p_base					=	ceil($width * $height * $busu * $rs_dc);
            }
        }
        else if($cvt_paper == '리무버블 유포지 80g (비코팅)' || $cvt_paper == '리무버블 유포지 80g (무광코팅)')
        {
            if($_POST['jCut'] == 'Y') {
                $width				=	min($_POST['jsize1']/10, $_POST['jsize2']/10);
                $height				=	max($_POST['jsize1']/10, $_POST['jsize2']/10);
            } else {
                $width				=	min($csize1/10, $csize2/10);
                $height				=	max($csize1/10, $csize2/10);
            }

            if($width >= 1 && $width <= 4 && $height <= 13) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc - 0.004;
                } else {
                    $rs_dc		=	$rs_dc + 0.0165;
                }
            } else if($width >= 1 && $width <= 4 && $height > 13) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc - 0.005;
                } else {
                    $rs_dc		=	$rs_dc + 0.0115;
                }
            } else if($width > 4 && $width <= 5 && $height <= 13) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc;
                } else {
                    $rs_dc		=	$rs_dc + 0.0315;
                }
            } else if($width > 4 && $width <= 5 && $height > 13) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc - 0.003;
                } else {
                    $rs_dc		=	$rs_dc + 0.0085;
                }
            } else if($width > 5 && $width <= 6 && $height <= 11) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc - 0.004;
                } else {
                    $rs_dc		=	$rs_dc + 0.0055;
                }
            } else if($width > 5 && $width <= 6 && $height > 11) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc - 0.0065;
                } else {
                    $rs_dc		=	$rs_dc;
                }
            } else if($width > 6) {
                if($bg_sk != "원터치재단") {
                    $rs_dc		=	$rs_dc - 0.0065;
                } else {
                    $rs_dc		=	$rs_dc;
                }
            }

            //$p_base					=	round($width * $height * $busu * $rs_dc, -2);
            if($bg_sk != "원터치재단"){
                //$p_base					=	round(($width + 0.6) * ($height + 0.6) * $busu * $rs_dc, -2);
                $p_base					=	ceil(($width + 0.6) * ($height + 0.6) * $busu * $rs_dc);
            } else {
                //$p_base					=	round($width * $height * $busu * $rs_dc, -2);
                $p_base					=	ceil($width * $height * $busu * $rs_dc);
            }
        }
        /*******************************
         *	else
         ********************************/
        else
        {
            $p_base				=	round($price_x * $price_y * $busu * $rs_dc, -2);
        }

        /*******************************
         *	$p_base <= $min_print
         ********************************/
        if($p_base <= $min_print)
        {
            $p_base				=	$min_print;
        }

        if($cate_sortcode == "004001001") {
            $p_dms = $p_mok = $p_mokdms = 0;
        } else if($cate_sortcode == "004003009" || $cate_sortcode == "004003010" || $cate_sortcode = "004004001") {
            if($bg_sk == "유형1") {
                $c_dms = 3000;
            } else if($bg_sk == "유형2") {
                $c_dms = 5000;
            } else if($bg_sk == "유형3") {
                $c_dms = 7000;
            } else if($bg_sk == "유형4" || $bg_sk == "혼합유형") {
                $c_dms = 9000;
            }
            $mok = $param['amt_ts'];
            $dms_unit				=	ceil($busu / 1000);
            $p_dms				=	( $c_dms * ($mok) ) * $dms_unit;

            $add_dms			=	$this->getDMSPrice(($esize1 / 10) * ($esize2 / 10)) * $dms_unit;
            $p_dms				=	$p_dms + $add_dms;
            //echo $p_dms;
            //echo "p_base : " . $p_base . " c_dms : " . $c_dms . " mok : " . $mok . " dms_unit : " . $dms_unit;
        }

        if($cate_sortcode == "004004001") {
            if($param["bef_tmpt"] == 332)
                $p_base *= 1.2;
            if($param["bef_tmpt"] == 334)
                $p_base *= 1.4;
        }
        $p_base					=	$p_base;//	+ $spotPrice; 별색
        $p_base					=	$p_base;// + $jCutPrice; 정재단

        $sub1						=	($p_base + $p_dms + $p_mok);
        $sub1						=	ceil(($sub1 * 1.1) / 100) * 100;

        return $sub1;
    }

    function getDMSPrice($area){
        $basicPrice					=	600;
        $k							=	1;
        for($i = 7; $i < 32; $i++){
            $start					=	$i * $i;
            $end					=	($i + 1) * ($i + 1);

            if ($area <= 49) {
                $dmsAddPrice		=	0;
                break;
            } else if ($area > 961) {
                $dmsAddPrice		=	15000;
                break;
            } else if ($area > $start && $area <= $end) {
                $dmsAddPrice		=	$basicPrice * $k;
                break;
            }
            $k++;
        }
        return $dmsAddPrice;
    }

    /**
     * @brief 명함류 비규격 자리수 계산
     *
     * @param $param = 계산용 파라미터
     * @detail 기본 가로/세로사이즈, 입력 가로/세로사이즈
     *
     * @return 계산된 자리수
     */
    public function ncCalcPos($param) {
        $default_wid  = doubleval($param["default_wid"]);
        $default_vert = doubleval($param["default_vert"]);

        $cut_wid  = doubleval($param["cut_wid"]);
        $cut_vert = doubleval($param["cut_vert"]);


        $calc_wid  = ceil($cut_wid / $default_wid) *
                     ceil($cut_vert / $default_vert);
        $calc_vert = ceil($cut_vert / $default_wid) *
                     ceil($cut_wid / $default_vert);

        if ($calc_wid == 1 || $calc_vert == 1) {
            return 1;
        } else if ($calc_wid > $calc_vert) {
            return $calc_wid;
        } else {
            return $calc_vert;
        }
    }

    /**
     * @brief 해당하는 카테고리(+일부 종이)에 
     * 해당하는 최대최소사이즈 검색
     *
     * @param $param = 카테고리 분류코드, 종이명
     *
     * @return size array
     */
    public function getMinMaxSize($param) {
        $cate_sortcode = $param["cate_sortcode"];
        $paper_name    = explode(' ' , $param["paper"])[0];

        $size_arr = MAX_MIN_SIZE_ARR[$cate_sortcode . "|" . $paper_name];
        if (!$size_arr) {
            $size_arr = MAX_MIN_SIZE_ARR[$cate_sortcode];
            
            if (empty($size_arr)) {
                $size_arr = $size_arr["ELSE"];
            }
        }
        return $size_arr;
    }

    /**
     * @brief 전단류 비규격 사이즈 근사치 검색
     *
     * @param $param = 계산용 파라미터
     * @detail 입력 가로/세로사이즈
     *
     * @return 
     */
    public function getSimilarSizeInfo($param): array {
        $cate_sortcode = $param["cate_sortcode"];
        $cut_wid  = intval($param["cut_wid"]);
        $cut_vert = intval($param["cut_vert"]);

        $temp = [];
        $temp["cate_sortcode"] = $cate_sortcode;
        $temp["wid"]           = $cut_wid;
        $temp["vert"]          = $cut_vert;
        $temp["mpcode"]        = $param["mpcode"];

        //$this->conn->debug = 1;
        $rs = $this->dao->selectSimilarStanInfo($this->conn, $temp);

        $org_cut_wid  = doubleval($rs["cut_wid_size"]);
        $org_cut_vert = doubleval($rs["cut_vert_size"]);

        if (empty($rs)) {
            $rs = $this->dao->selectMaxStanInfo($this->conn, $temp);

            $org_cut_wid  = doubleval($rs["cut_wid_size"]);
            $org_cut_vert = doubleval($rs["cut_vert_size"]);

            $min_max_arr = $this->getMinMaxSize([
                "cate_sortcode" => $cate_sortcode
            ]);

            $max_wid = $min_max_arr["MAX_WID"];
            $max_vert = $min_max_arr["MAX_VERT"];

            if (empty($max_wid)) {
                $max_wid = $org_cut_wid;
            }
            if (empty($max_vert)) {
                $max_vert = $org_cut_vert;
            }
        }

        return [
            "name"   => $rs["name"],
            "affil"  => $rs["affil"],
            "mpcode" => $rs["mpcode"],
            "org_cut_wid"  => $org_cut_wid,
            "org_cut_vert" => $org_cut_vert,
            "max_wid_size"  => $max_wid,
            "max_vert_size" => $max_vert
        ];
    }

    function startsWith($haystack, $needle) {
        // search backwards starting from haystack length characters from the end
        return $needle === "" || strrpos($haystack, $needle, -strlen($haystack)) !== false;
    }

}
?>
